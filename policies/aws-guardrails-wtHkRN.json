{"Version":"2012-10-17","Statement":[{"Condition":{"ArnNotLike":{"aws:PrincipalARN":["arn:*:iam::*:role/AWSControlTowerExecution"]}},"Resource":"arn:*:s3:::aws-controltower-config-*","Effect":"Deny","NotAction":["s3:DeleteObject","s3:DeleteObjectTagging","s3:DeleteObjectVersion","s3:DeleteObjectVersionTagging","s3:Get*","s3:List*","s3:PutBucketTagging","s3:PutObject","s3:PutObjectAcl","s3:PutObjectLegalHold","s3:PutObjectRetention","s3:PutObjectTagging","s3:PutObjectVersionAcl","s3:PutObjectVersionTagging","s3:RestoreObject"],"Sid":"CTS3PV7"},{"Condition":{"ArnNotLike":{"aws:PrincipalARN":"arn:*:iam::*:role/AWSControlTowerExecution"}},"Action":["sns:Subscribe","sns:Unsubscribe"],"Resource":"arn:*:sns:*:*:aws-controltower-SecurityNotifications","Effect":"Deny","Sid":"GRSNSSUBSCRIPTIONPOLICY"},{"Condition":{"ArnNotLike":{"aws:PrincipalArn":["arn:*:iam::*:role/AWSControlTowerExecution","arn:*:iam::*:role/stacksets-exec-*"]}},"Action":["iam:AttachRolePolicy","iam:CreateRole","iam:DeleteRole","iam:DeleteRolePermissionsBoundary","iam:DeleteRolePolicy","iam:DetachRolePolicy","iam:PutRolePermissionsBoundary","iam:PutRolePolicy","iam:UpdateAssumeRolePolicy","iam:UpdateRole","iam:UpdateRoleDescription"],"Resource":["arn:*:iam::*:role/aws-controltower-*","arn:*:iam::*:role/*AWSControlTower*","arn:*:iam::*:role/stacksets-exec-*"],"Effect":"Deny","Sid":"GRIAMROLEPOLICY"},{"Condition":{"ArnNotLike":{"aws:PrincipalARN":["arn:*:iam::*:role/AWSControlTowerExecution"]}},"Resource":["arn:*:s3:::aws-controltower-access-logs-*","arn:*:s3:::aws-controltower-cloudtrail-*","arn:*:s3:::aws-controltower-logs-*"],"Effect":"Deny","NotAction":["s3:DeleteObject","s3:DeleteObjectTagging","s3:DeleteObjectVersion","s3:DeleteObjectVersionTagging","s3:Get*","s3:List*","s3:PutBucketTagging","s3:PutObject","s3:PutObjectAcl","s3:PutObjectLegalHold","s3:PutObjectRetention","s3:PutObjectTagging","s3:PutObjectVersionAcl","s3:PutObjectVersionTagging","s3:RestoreObject"],"Sid":"CTS3PV8"},{"Condition":{"StringNotLike":{"aws:PrincipalArn":["arn:*:iam::*:role/AWSControlTowerExecution"]}},"Action":["logs:DeleteLogGroup","logs:PutRetentionPolicy"],"Resource":"arn:*:logs:*:*:log-group:*aws-controltower*","Effect":"Deny","Sid":"GRLOGGROUPPOLICY"},{"Condition":{"ArnNotLike":{"aws:PrincipalARN":"arn:*:iam::*:role/AWSControlTowerExecution"}},"Action":["config:DeleteConfigurationRecorder","config:DeleteDeliveryChannel","config:DeleteRetentionConfiguration","config:PutConfigurationRecorder","config:PutDeliveryChannel","config:PutRetentionConfiguration","config:StopConfigurationRecorder"],"Resource":"*","Effect":"Deny","Sid":"GRCONFIGENABLED"},{"Condition":{"ArnNotLike":{"aws:PrincipalARN":"arn:*:iam::*:role/AWSControlTowerExecution"}},"Action":["lambda:AddPermission","lambda:CreateEventSourceMapping","lambda:CreateFunction","lambda:DeleteEventSourceMapping","lambda:DeleteFunction","lambda:DeleteFunctionConcurrency","lambda:PutFunctionConcurrency","lambda:RemovePermission","lambda:UpdateEventSourceMapping","lambda:UpdateFunctionCode","lambda:UpdateFunctionConfiguration"],"Resource":"arn:*:lambda:*:*:function:aws-controltower-*","Effect":"Deny","Sid":"GRLAMBDAFUNCTIONPOLICY"},{"Condition":{"ArnNotLike":{"aws:PrincipalARN":"arn:*:iam::*:role/AWSControlTowerExecution"}},"Action":["sns:AddPermission","sns:CreateTopic","sns:DeleteTopic","sns:RemovePermission","sns:SetTopicAttributes"],"Resource":["arn:*:sns:*:*:aws-controltower-AggregateSecurityNotifications*","arn:*:sns:*:*:aws-controltower-AllConfigNotifications*","arn:*:sns:*:*:aws-controltower-SecurityNotifications*"],"Effect":"Deny","Sid":"GRSNSTOPICPOLICY"},{"Condition":{"ArnNotLike":{"aws:PrincipalARN":["arn:*:iam::*:role/AWSControlTowerExecution"]}},"Resource":"arn:*:sns:*:*:aws-controltower-CentralizedLoggingNotifications*","Effect":"Deny","NotAction":["sns:ConfirmSubscription","sns:Get*","sns:List*","sns:Publish","sns:PutDataProtectionPolicy","sns:Subscribe","sns:TagResource","sns:Unsubscribe","sns:UntagResource"],"Sid":"CTSNSPV1"},{"Condition":{"ArnNotLike":{"aws:PrincipalARN":"arn:*:iam::*:role/AWSControlTowerExecution"}},"Action":["events:DeleteRule","events:DisableRule","events:PutRule","events:PutTargets","events:RemoveTargets"],"Resource":"arn:*:events:*:*:rule/aws-controltower-*","Effect":"Deny","Sid":"GRCLOUDWATCHEVENTPOLICY"},{"Condition":{"StringEquals":{"aws:ResourceTag/aws-control-tower":"managed-by-control-tower"},"ArnNotLike":{"aws:PrincipalARN":"arn:*:iam::*:role/AWSControlTowerExecution"}},"Action":["config:DeleteConfigRule","config:DeleteConfigurationAggregator","config:DeleteEvaluationResults","config:PutConfigRule","config:PutConfigurationAggregator"],"Resource":"*","Effect":"Deny","Sid":"GRCONFIGRULEPOLICY"}]}
